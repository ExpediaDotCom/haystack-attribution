module "attributor" {
  source = "attributor"
  image = "${var.haystack-attribution["docker_registry"]}/library/haystack-attributor:${var.haystack-attribution["version"]}"
  replicas = "${var.haystack-attribution["attributor_instances"]}"
  namespace = "${var.namespace}"
  elasticsearch_endpoint = "${var.elasticsearch_hostname}:${var.elasticsearch_port}"
  kafka_endpoint = "${var.kafka_hostname}:${var.kafka_port}"
  cassandra_hostname = "${var.cassandra_hostname}"
  graphite_hostname = "${var.graphite_hostname}"
  graphite_port = "${var.graphite_port}"
  graphite_enabled = "${var.graphite_enabled}"
  enabled = "${var.haystack-attribution["enabled"]}"
  node_selector_label = "${var.node_selector_label}"
  kubectl_executable_name = "${var.kubectl_executable_name}"
  kubectl_context_name = "${var.kubectl_context_name}"
  cpu_limit = "${var.haystack-attribution["attributor_cpu_limit"]}"
  cpu_request = "${var.haystack-attribution["attributor_cpu_request"]}"
  memory_limit = "${var.haystack-attribution["attributor_memory_limit"]}"
  memory_request = "${var.haystack-attribution["attributor_memory_request"]}"
  jvm_memory_limit = "${var.haystack-attribution["attributor_jvm_memory_limit"]}"
  attributor_tags = "${var.haystack-attribution["attributor_tags"]}"
  num_stream_threads = "${var.haystack-attribution["attributor_num_stream_threads"]}"
  env_vars = "${var.haystack-attribution["attributor_environment_overrides"]}"
}

module "attribution-persistence-email" {
  source = "attribution-persistence-email"
  image = "${var.haystack-attribution["docker_registry"]}/library/haystack-attribution-persistence-email:${var.haystack-attribution["version"]}"
  replicas = "${var.haystack-attribution["attribution-persistence-email_instances"]}"
  namespace = "${var.namespace}"
  graphite_hostname = "${var.graphite_hostname}"
  graphite_port = "${var.graphite_port}"
  graphite_enabled = "${var.graphite_enabled}"
  enabled = "${var.haystack-attribution["enabled"]}"
  node_selector_label = "${var.node_selector_label}"
  kubectl_executable_name = "${var.kubectl_executable_name}"
  kubectl_context_name = "${var.kubectl_context_name}"
  cpu_limit = "${var.haystack-attribution["attribution-persistence-email_cpu_limit"]}"
  cpu_request = "${var.haystack-attribution["attribution-persistence-email_cpu_request"]}"
  memory_limit = "${var.haystack-attribution["attribution-persistence-email_memory_limit"]}"
  memory_request = "${var.haystack-attribution["attribution-persistence-email_memory_request"]}"
  jvm_memory_limit = "${var.haystack-attribution["attribution-persistence-email_jvm_memory_limit"]}"
  environment_name = "${var.haystack-attribution["environment_name"]}"
  attribution_to_email_ids = "${var.haystack-attribution["attribution_to_email_ids"]}"
  attribution_from_email_id = "${var.haystack-attribution["attribution_from_email_id"]}"
  attributor_tags = "${var.haystack-attribution["attributor_tags"]}"
  attribution_email_subject_line = "${var.haystack-attribution["attribution_email_subject_line"]}"
  attribution_email_override_template = "${var.haystack-attribution["attribution_email_override_template"]}"
  env_vars = "${var.haystack-attribution["attribution-persistence-email_environment_overrides"]}"
}

module "attribution-persistence-s3" {
  source = "attribution-persistence-s3"
  image = "${var.haystack-attribution["docker_registry"]}/library/haystack-attribution-persistence-s3:${var.haystack-attribution["version"]}"
  replicas = "${var.haystack-attribution["attribution-persistence-s3_instances"]}"
  namespace = "${var.namespace}"
  graphite_hostname = "${var.graphite_hostname}"
  graphite_port = "${var.graphite_port}"
  graphite_enabled = "${var.graphite_enabled}"
  enabled = "${var.haystack-attribution["enabled"]}"
  node_selector_label = "${var.node_selector_label}"
  kubectl_executable_name = "${var.kubectl_executable_name}"
  kubectl_context_name = "${var.kubectl_context_name}"
  cpu_limit = "${var.haystack-attribution["attribution-persistence-s3_cpu_limit"]}"
  cpu_request = "${var.haystack-attribution["attribution-persistence-s3_cpu_request"]}"
  memory_limit = "${var.haystack-attribution["attribution-persistence-s3_memory_limit"]}"
  memory_request = "${var.haystack-attribution["attribution-persistence-s3_memory_request"]}"
  jvm_memory_limit = "${var.haystack-attribution["attribution-persistence-s3_jvm_memory_limit"]}"
  environment_name = "${var.haystack-attribution["environment_name"]}"
  attribution_s3_transformers_config = "${var.haystack-attribution["attribution_s3_transformers_config"]}"
  attribution_s3_aws_config = "${var.haystack-attribution["attribution_s3_aws_config"]}"
  attributor_tags = "${var.haystack-attribution["attributor_tags"]}"
  env_vars = "${var.haystack-attribution["attribution-persistence-s3_environment_overrides"]}"
}
